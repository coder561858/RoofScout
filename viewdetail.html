<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RoofScout - Details</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-800">

  <!-- Header -->
  <div class="sticky top-0 z-50 flex gap-6 h-20 p-4 items-center bg-white shadow-lg">
    <div class="flex items-center">
      <img src="LogoRS.png" alt="Logo" class="h-16 w-16 mr-2 hidden sm:block">
      <h1 class="font-bold text-2xl text-yellow-500"><a href="index.html">Roof</a></h1>
      <h1 class="font-bold text-2xl text-blue-600"><a href="index.html">Scout</a></h1>
    </div>
  </div>

  <!-- Breadcrumb -->
  <div class="px-6 py-3 text-sm text-gray-600">
    <a href="index.html" class="hover:text-black">Home</a> /
    <a href="allproperties.html" class="hover:text-black">Properties</a> /
    <span id="breadcrumb-title">Property Details</span>
  </div>

  <!-- Property Image -->
  <section class="w-full md:w-1/2 mx-auto mt-4">
    <img id="prop-image" src="https://images.unsplash.com/photo-1568605114967-8130f3a36994" alt="Property" class="w-full h-96 object-cover rounded-lg shadow-md">
  </section>

  <!-- Price & Description -->
  <section class="p-6 md:p-8 flex flex-col lg:flex-row gap-8 max-w-6xl mx-auto">
    <div class="flex-1">
      <div id="prop-price" class="flex items-center text-green-600 text-3xl font-bold mb-4">₹ 1000 <span class="text-base text-gray-500 ml-2">/month</span></div>
      <h2 id="prop-title" class="text-2xl font-semibold mb-2">Property Description</h2>
      <p id="prop-desc" class="text-gray-600 leading-relaxed">Default description. Clicked card info will populate here when available.</p>
      <p class="mt-4 text-gray-700"><span class="font-semibold">Address:</span> <span id="prop-address">Unknown</span></p>
    </div>

    

    <div class="w-full lg:w-1/3 border-2 border-gray-400 p-4 rounded-lg shadow-sm">
      <h3 class="text-xl font-semibold mb-4 flex justify-center items-center">Quick Summary</h3>
      <ul class="space-y-2 text-gray-700">
        <li><span class="font-semibold">Property ID:</span> <span id="quick-id">-</span></li>
        <li><span class="font-semibold">Location:</span> <span id="quick-location">-</span></li>
        <li><span class="font-semibold">Property Type:</span> <span id="quick-type">-</span></li>
        <li><span class="font-semibold">Status:</span> <span id="quick-status">Sale</span></li>
        <li><span class="font-semibold">Area:</span> <span id="quick-area">-</span></li>
        <li><span class="font-semibold">Beds:</span> <span id="quick-beds">-</span></li>
        <li><span class="font-semibold">Bath:</span> <span id="quick-bath">-</span></li>
        <li><span class="font-semibold">Garages:</span> <span id="quick-garage">-</span></li>
      </ul>
    </div>
  </section>

  <!-- Dealer & Enquiry -->
  <div class="max-w-6xl mx-auto bg-white p-8 md:p-10 shadow-lg rounded-2xl flex flex-col md:flex-row gap-10 my-10">
    
    <!-- Dealer Details -->
    <div class="w-full md:w-5/12 pr-6 md:border-r border-gray-200 space-y-4">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4 border-b pb-2">Owner Details</h2>

      <div class="flex items-start space-x-4">
        <div class="w-[80px] h-[100px] flex-shrink-0 rounded-md overflow-hidden shadow-sm">
         <img src="image.png" class="max-w-[90px] absolute z-50 icon rounded-2xl">
        </div>
        

        <div class="flex flex-col space-y-1">
          <h3 class="text-lg font-bold text-blue-600">BOB</h3>
          <button class="bg-teal-500 hover:bg-teal-600 text-white font-medium py-1.5 px-4 rounded text-sm mt-1 transition duration-150">
            View Phone Number
          </button>
        </div>
      </div>

      <div class="pt-3 space-y-2 text-sm text-gray-700 leading-relaxed">
        <p><span class="font-semibold text-gray-600">Properties Listed:</span> <span class="font-bold text-gray-900">8</span></p>
        <p><span class="font-semibold text-gray-600">Localities:</span> <span class="text-gray-800">Kalwa, Baran, Hardaspur, Heera Bagh</span></p>
        <p><span class="font-semibold text-gray-600">Address:</span> <span class="text-gray-800">A Tarik Adalat Bazar, Patiala</span></p>
      </div>
    </div>

    <!-- Enquiry Form -->
    <div class="w-full md:w-7/12 space-y-6">
      <h2 class="text-2xl font-semibold text-gray-800 mb-2 border-b pb-2">Send Enquiry to Owner</h2>

      <form id="enquiryForm" class="space-y-5 text-sm">

        <!-- User type and reason -->
        <div class="flex flex-wrap items-center gap-6 text-gray-700">
          <span class="font-medium">You are</span>
          <label class="flex items-center space-x-2">
            <input type="radio" name="user_type" value="individual">
            <span>Individual</span>
          </label>
          <label class="flex items-center space-x-2">
            <input type="radio" name="user_type" value="dealer" class="text-blue-600 focus:ring-blue-500">
            <span>Dealer</span>
          </label>
        </div>

        <div class="flex flex-wrap items-center gap-6 text-gray-700">
          <span class="font-medium">Your reason to buy is</span>
          <label class="flex items-center space-x-2">
            <input type="radio" name="reason_to_buy" value="investment">
            <span>Investment</span>
          </label>
          <label class="flex items-center space-x-2">
            <input type="radio" name="reason_to_buy" value="self_use">
            <span>Self Use</span>
          </label>
        </div>

        <!-- Name & Message -->
        <div class="flex flex-col md:flex-row gap-4">
          <input id="name" type="text" name="name" placeholder="Your Name" class="w-full md:w-5/12 border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition duration-150 h-1/2">
          <div class="relative w-full md:w-7/12">
            <textarea id="area" name="message" placeholder="I am interested in this property." class="w-full h-32 border border-gray-300 p-2 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-400 transition duration-150"></textarea>
            <span class="absolute bottom-1 right-2 text-xs text-gray-400">Max 400 chars</span>
          </div>
        </div>

        <!-- Phone -->
        <div class="flex flex-col sm:flex-row gap-4">
          <select name="country_code" class="sm:w-2/12 border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
            <option value="+91">IND (+91)</option>
            <option value="+1">US (+1)</option>
            <option value="+44">UK (+44)</option>
          </select>
          <input type="tel" name="phone" placeholder="Phone Number" class="w-full border border-gray-300 p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-400 transition duration-150">
        </div>

        <!-- Terms -->
        <div class="text-xs text-gray-600">
          <label class="flex items-start space-x-2">
            <input type="checkbox" checked class="mt-1 text-blue-600 focus:ring-blue-500">
            <span>I agree to the 
              <a href="#" class="text-blue-600 hover:underline font-medium">Terms & Conditions</a> and 
              <a href="#" class="text-blue-600 hover:underline font-medium">Privacy Policy</a>.
            </span>
          </label>
        </div>

        <!-- Buttons -->
        <div class="flex flex-wrap gap-4 items-center">
          <button type="submit" id="submit2" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 px-8 rounded-md text-sm shadow-lg transition duration-200">
            Send Email & SMS
          </button>

          <!-- Request Tour -->
          <div class="relative inline-block">
            <button type="button" id="dropdownBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-md font-semibold transition duration-200">
              Request a Tour
            </button>
            <div id="dropdownMenu" class="hidden absolute right-0 mt-2 w-56 bg-gray-800 text-white rounded-md shadow-lg z-10">
              <a href="#" class="block px-4 py-2 hover:bg-gray-700">Today</a>
              <a href="#" class="block px-4 py-2 hover:bg-gray-700">Tomorrow</a>
              <a href="#" class="block px-4 py-2 hover:bg-gray-700">Next Week</a>
            </div>
          </div>

          <!-- Time button (hidden initially) -->
          <div id="timeWrapper" class="relative inline-block hidden">
            <button type="button" id="timeBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-md font-semibold transition duration-200">
              Select Time
            </button>
            <div id="timeMenu" class="hidden absolute right-0 mt-2 w-56 bg-gray-800 text-white rounded-md shadow-lg z-10">
              <a class="block px-4 py-2 hover:bg-gray-700 cursor-pointer">10:00 AM</a>
              <a class="block px-4 py-2 hover:bg-gray-700 cursor-pointer">12:30 PM</a>
              <a class="block px-4 py-2 hover:bg-gray-700 cursor-pointer">03:00 PM</a>
              <a class="block px-4 py-2 hover:bg-gray-700 cursor-pointer">05:30 PM</a>
            </div>
          </div>

          <!-- Request button -->
          <button id="Requestbtn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-md font-semibold transition duration-200 hidden">Request</button>
        </div>

      </form>
    </div>
  </div>

  <script>

    const dropdown = document.getElementById("dropdownBtn");
    const menu = document.getElementById("dropdownMenu");
    const timeWrapper = document.getElementById("timeWrapper");
    const timeBtn = document.getElementById("timeBtn");
    const timeMenu = document.getElementById("timeMenu");
    const request = document.getElementById("Requestbtn");
    const send = document.getElementById("submit2");
    const requestStatusMessage = document.getElementById('requestStatus');

    // Show time and request button after clicking "Request a Tour"
    dropdown.addEventListener("click", (e) => {
      e.preventDefault();
      menu.classList.toggle("hidden");
      timeWrapper.classList.remove("hidden");
      request.classList.remove("hidden");
    });

    // Tour selection
    menu.querySelectorAll("a").forEach(option => {
      option.addEventListener("click", (e) => {
        e.preventDefault();
        dropdown.textContent = option.textContent;
        menu.classList.add("hidden");
      });
    });

    // Time dropdown toggle
    timeBtn.addEventListener("click", () => {
      timeMenu.classList.toggle("hidden");
    });

    // Time selection
    timeMenu.querySelectorAll("a").forEach(option => {
      option.addEventListener("click", (e) => {
        e.preventDefault();
        timeBtn.textContent = option.textContent;
        timeMenu.classList.add("hidden");
      });
    });

    // Request button click
    request.addEventListener("click", (e) => {
      e.preventDefault();
      const selectedTime = timeBtn.textContent.trim();
      if (selectedTime === "Select Time") {
        alert("Please select a valid time!");
      } else {
        alert("Request Successful for " + selectedTime + "!");
        // **** START: Code to ADD inside the 'request' button's 'else' block ****

// Get property details needed for the application
const currentPropertyId = document.getElementById('quick-id')?.textContent || Date.now().toString();
const currentPropertyTitle = document.getElementById('prop-title')?.textContent || 'Unknown Property';
const currentPropertyType = document.getElementById('quick-type')?.textContent || 'Unknown';
const requestStatusMessage = document.getElementById('requestStatus'); // Find status element

// Check if user has ALREADY applied for THIS property
const appliedProperties = JSON.parse(localStorage.getItem('appliedProperties')) || [];
const alreadyApplied = appliedProperties.some(app => app.propertyId === currentPropertyId);

if (!alreadyApplied) {
    // Only save if not already applied
    console.log('Saving application for property ID:', currentPropertyId);

    // 1. Create the application object
    const newApplication = {
        propertyId: currentPropertyId,
        title: currentPropertyTitle,
        propertyType: currentPropertyType,
        appliedDate: new Date().toISOString(),
        status: 'Pending' // Initial status
    };

    // 2. Get existing applications from localStorage (already done above)
    // 3. Add the new application
    appliedProperties.push(newApplication);

    // 4. Save the updated list back to localStorage
    localStorage.setItem('appliedProperties', JSON.stringify(appliedProperties));

    // 5. Update UI (optional: show message, disable button)
    console.log('Application Saved:', newApplication);
    if(requestStatusMessage) {
        requestStatusMessage.textContent = 'Application submitted successfully!';
        requestStatusMessage.classList.remove('hidden');
    }
    // Optionally disable the request button after applying
    request.textContent = 'Applied';
    request.disabled = true;

} else {
    // Already applied, maybe show a different message
    console.log('Already applied for property ID:', currentPropertyId);
     if(requestStatusMessage) {
        requestStatusMessage.textContent = 'You have already applied for this property.';
        requestStatusMessage.classList.remove('hidden');
        requestStatusMessage.classList.replace('text-green-700','text-blue-700'); // Change color
    }
    request.textContent = 'Already Applied';
    request.disabled = true;
}

// **** END: Code to ADD inside the 'request' button's 'else' block ****
      }
    });

    // Send Email & SMS
    send.addEventListener('click', (e) => {
  e.preventDefault(); 

  const nameInput = document.getElementById("name").value.trim();
  const messageInput = document.getElementById("area").value.trim();

  if (nameInput === "" || messageInput === "") {
    alert("Please fill in both Name and Message before sending.");
    return; // Stop execution
  }

  alert("Message sent successfully!");
});


    (function () {
      const params = new URLSearchParams(window.location.search);
      const houseId = params.get('houseId');

      // DATA map fallback (local known data)
      const DATA = {
        '4060': {
          title: 'Mansa, Punjab',
          priceText: '₹2-10 Cr',
          desc: 'Spacious property in Mansa with good connectivity and amenities.',
          address: 'Mansa, Punjab',
          location: 'Mansa, Punjab',
          type: 'House',
          area: '2200 sqft',
          owner: 'Admin',
          image: 'house1pb.jpg',
          beds: 4,
          baths: 3,
          garages: 2
        },
        '4061': {
          title: '405 Dera Bassi, Punjab',
          priceText: '₹5-19 Cr',
          desc: 'Large family home in Dera Bassi with expansive grounds.',
          address: '405 Dera Bassi, Punjab',
          location: 'Dera Bassi, Punjab',
          type: 'House',
          area: '3500 sqft',
          owner: 'Admin',
          image: 'house2pb.jpg',
          beds: 5,
          baths: 4,
          garages: 3
        },
        '4062': {
          title: '324 Tara Place, Punjab',
          priceText: '₹50-90 Lacs',
          desc: 'Comfortable home at Tara Place, ideal for small families.',
          address: '324 Tara Place, Punjab',
          location: 'Tara Place, Punjab',
          type: 'House',
          area: '1200 sqft',
          owner: 'Admin',
          image: 'house3pb.jpg',
          beds: 2,
          baths: 1,
          garages: 1
        },
        '4063': {
          title: '324 Tara Place (2), Punjab',
          priceText: '₹1-5 Cr',
          desc: 'Renovated property with modern fittings and garden.',
          address: '324 Tara Place, Punjab',
          location: 'Tara Place, Punjab',
          type: 'House',
          area: '1800 sqft',
          owner: 'Admin',
          image: 'house4pb.jpg',
          beds: 3,
          baths: 2,
          garages: 1
        },
        '4064': {
          title: '502 Lakeview Drive, Punjab',
          priceText: '₹5-12 Cr',
          desc: 'Spacious 4BR with scenic views and renovated kitchen.',
          address: '502 Lakeview Drive, Punjab',
          location: 'Lakeview, Punjab',
          type: 'House',
          area: '4200 sqft',
          owner: 'Admin',
          image: 'house5pb.jpg',
          beds: 4,
          baths: 4,
          garages: 2
        },
        '4065': {
          title: 'Premium Estate, Punjab',
          priceText: '₹5-10 Cr',
          desc: 'Large estate with high-end finishes and extra land.',
          address: 'Premium Estate, Punjab',
          location: 'Punjab',
          type: 'House',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'house6pb.jpg',
          beds: 6,
          baths: 5,
          garages: 4
        },
        // Plots shown on state.html (no beds/baths/garages)
        '5060': {
          title: 'Mansa Plot, Punjab',
          priceText: '₹5 Cr',
          desc: 'Open plot in Mansa suitable for development.',
          address: 'Mansa, Punjab',
          location: 'Mansa, Punjab',
          type: 'Plot',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'https://th.bing.com/th/id/OIP.rtBKbxWD-cO_JbfK9Rl8KgHaFj?w=222&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7'
        },
        '5061': {
          title: 'Dera Bassi Plot, Punjab',
          priceText: '₹5 Cr',
          desc: 'Well-located plot near Dera Bassi.',
          address: 'Dera Bassi, Punjab',
          location: 'Dera Bassi, Punjab',
          type: 'Plot',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'https://th.bing.com/th/id/OIP.fjA63g4LynWtnfeCIwuO0wHaEK?w=265&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7'
        },
        '5062': {
          title: 'Tara Place Plot, Punjab',
          priceText: '₹5 Cr',
          desc: 'Plot in Tara Place area with easy access to roads.',
          address: 'Tara Place, Punjab',
          location: 'Tara Place, Punjab',
          type: 'Plot',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'https://th.bing.com/th/id/OIP.8XehqTzGtglzlbPglw_jxQHaEJ?w=328&h=184&c=7&r=0&o=5&dpr=1.3&pid=1.7'
        },
        '5063': {
          title: 'Central Plot, Punjab',
          priceText: '₹5 Cr',
          desc: 'Central plot suitable for residential or commercial use.',
          address: 'Central, Punjab',
          location: 'Punjab',
          type: 'Plot',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'https://th.bing.com/th/id/OIP.t5si8dD57J5rZX4fWK5jagAAAA?w=224&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7'
        },
        '5064': {
          title: 'South Plot, Punjab',
          priceText: '₹4 Cr',
          desc: 'Affordable plot in a growing suburb.',
          address: 'South Area, Punjab',
          location: 'Punjab',
          type: 'Plot',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'https://th.bing.com/th/id/OIP.S-nsr8yVkJzy9AFgomOHYwAAAA?w=230&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7'
        },
        '5065': {
          title: 'West Plot, Punjab',
          priceText: '₹2 Cr',
          desc: 'Budget-friendly plot for quick possession.',
          address: 'West Area, Punjab',
          location: 'Punjab',
          type: 'Plot',
          area: '5000 sqft',
          owner: 'Admin',
          image: 'https://th.bing.com/th/id/OIP.5k9mVM1IqxncdzJL8fA5jgHaFj?w=254&h=191&c=7&r=0&o=5&dpr=1.3&pid=1.7'
        }
      };

      // Helper to set fields from an object
      function applyData(d, idFromParams) {
        if (!d) return;
        if (d.title) document.getElementById('prop-title').textContent = d.title;
        if (d.title) document.getElementById('breadcrumb-title').textContent = d.title;
        if (d.desc) document.getElementById('prop-desc').textContent = d.desc;
        if (d.address) document.getElementById('prop-address').textContent = d.address;
        if (d.priceText) document.getElementById('prop-price').textContent = d.priceText;
        if (idFromParams) document.getElementById('quick-id').textContent = idFromParams;
        if (d.location) document.getElementById('quick-location').textContent = d.location;
        if (d.type) document.getElementById('quick-type').textContent = d.type;
        if (d.area) document.getElementById('quick-area').textContent = d.area;
        // Set beds/baths/garages if present (use '-' when not available)
        document.getElementById('quick-beds').textContent = d.beds !== undefined ? d.beds : '-';
        document.getElementById('quick-bath').textContent = d.baths !== undefined ? d.baths : '-';
        document.getElementById('quick-garage').textContent = d.garages !== undefined ? d.garages : '-';
        if (d.owner) {
          // keep owner usage for future if needed
        }
        if (d.image) document.getElementById('prop-image').src = d.image;
      }

      // First prefer explicit query params (these come from adm/state pages)
      const q = {
        title: params.get('title'),
        desc: params.get('desc'),
        address: params.get('address'),
        priceText: params.get('priceText'),
        image: params.get('image'),
        owner: params.get('owner'),
        location: params.get('location') || params.get('district'),
        type: params.get('type'),
        area: params.get('area'),
        beds: params.get('beds'),
        baths: params.get('baths'),
        garages: params.get('garages')
      };

      // if any important param exists, use params to populate
      if (q.title || q.desc || q.image || q.priceText || q.owner) {
        const fromQuery = {
          title: q.title,
          desc: q.desc,
          address: q.address,
          priceText: q.priceText,
          image: q.image,
          owner: q.owner,
          location: q.location,
          type: q.type,
          area: q.area,
          beds: q.beds !== null ? q.beds : undefined,
          baths: q.baths !== null ? q.baths : undefined,
          garages: q.garages !== null ? q.garages : undefined
        };
        applyData(fromQuery, houseId);
      } else if (houseId && DATA[houseId]) {
        applyData(DATA[houseId], houseId);
      } else if (houseId) {
        document.getElementById('breadcrumb-title').textContent = 'Property ' + houseId;
        document.getElementById('quick-id').textContent = houseId;
      }
    })();

  dropdown.addEventListener("click", (e) => {
  e.preventDefault();

  const nameInput = document.getElementById("name").value.trim();
  const messageInput = document.getElementById("area").value.trim();

  if (nameInput === "" || messageInput === "") {
    alert("Please enter your Name and Message before requesting a tour.");
    return; // Stop request tour
  }
});
    
  </script>

</body>
</html>
